<!-- <section>

    <div class="container my-4">
      <h1 class="text-center mb-4 heading">Drafting Legal Documents</h1>
      <mat-horizontal-stepper labelPosition="bottom" linear class="custom-stepper">
        <mat-step label="Shipping Address" completed="true">
          <p class="step-content">Shipping Address Details</p>
        </mat-step>
        <mat-step label="Billing Address" completed="false" optional>
          <p class="step-content">Billing Address Details</p>
          <div class="step-buttons">
            <button mat-stroked-button color="primary" matStepperPrevious>
              Back
            </button>
            <button mat-flat-button color="primary" matStepperNext>
              Next
            </button>
          </div>
        </mat-step>
        <mat-step label="Place Order" completed="false">
          <p class="step-content">Order Details</p>
        </mat-step>
      </mat-horizontal-stepper>
    </div>

  </section> -->

<section>
  <div class="container my-4">
    <h1 class="text-center mb-4 heading">Drafting Legal Documents</h1>

    <!-- âœ… Wrap entire stepper once -->
    <form [formGroup]="stepForm">
      <mat-horizontal-stepper linear class="custom-stepper">

        <!-- Step 1 -->
        <mat-step [stepControl]="stepForm.get('state')!">
          <mat-form-field appearance="fill" class="w-100">
            <mat-label>Select State</mat-label>
            <mat-select formControlName="state" (selectionChange)="onStateChange()">
              <mat-option *ngFor="let state of states" [value]="state">{{ state }}</mat-option>
            </mat-select>
          </mat-form-field>
          <div class="mt-3">
            <button mat-raised-button color="primary" matStepperNext [disabled]="!stepForm.get('state')?.valid">
              Next
            </button>
          </div>
        </mat-step>

        <!-- Step 2 -->
        <mat-step [stepControl]="stepForm.get('category')!">
          <mat-form-field appearance="fill" class="w-100">
            <mat-label>Select Category</mat-label>
            <mat-select formControlName="category" (selectionChange)="onCategoryChange()">
              <mat-option *ngFor="let cat of categories" [value]="cat">{{ cat }}</mat-option>
            </mat-select>
          </mat-form-field>
          <div class="mt-3">
            <button mat-button matStepperPrevious>Back</button>
            <button mat-raised-button color="primary" matStepperNext [disabled]="!stepForm.get('category')?.valid">
              Next
            </button>
          </div>
        </mat-step>

        <!-- Step 3 -->
        <mat-step [stepControl]="stepForm.get('subcategory')!">
          <mat-form-field appearance="fill" class="w-100">
            <mat-label>Select Document</mat-label>
            <mat-select formControlName="subcategory" (selectionChange)="onSubcategoryChange()">
              <mat-option *ngFor="let sub of subcategories" [value]="sub">{{ sub }}</mat-option>
            </mat-select>
          </mat-form-field>
          <div class="mt-3">
            <button mat-button matStepperPrevious>Back</button>
            <button mat-raised-button color="primary" matStepperNext [disabled]="!stepForm.get('subcategory')?.valid">
              Next
            </button>
          </div>
        </mat-step>

        <!-- Step 4 -->
        <mat-step [stepControl]="formDataGroup">
          <form [formGroup]="formDataGroup" (ngSubmit)="onSubmit()">
            <div *ngFor="let field of dynamicFields" class="mb-3">
              <mat-form-field appearance="fill" class="w-100" *ngIf="field.type !== 'textarea'">
                <mat-label>{{ field.label }}</mat-label>
                <input matInput [type]="field.type" [formControlName]="field.controlName" />
              </mat-form-field>

              <mat-form-field appearance="fill" class="w-100" *ngIf="field.type === 'textarea'">
                <mat-label>{{ field.label }}</mat-label>
                <textarea matInput [formControlName]="field.controlName"></textarea>
              </mat-form-field>
            </div>
            <button mat-button matStepperPrevious>Back</button>
            <button mat-raised-button color="accent" type="submit" [disabled]="!formDataGroup.valid">Submit</button>
          </form>
        </mat-step>

      </mat-horizontal-stepper>
    </form>
  </div>
</section>
